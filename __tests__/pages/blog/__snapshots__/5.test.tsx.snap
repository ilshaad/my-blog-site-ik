// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`<5/> blog page snapshot blog post 5 1`] = `
<div>
  <div
    class="blogPostPage container"
  >
    <div
      class="svgLinks text-primary mt-2 container"
    >
      <span
        class="ms-2 me-2"
      >
        <svg
          class="bi bi-house text-decoration-underline mx-auto p-0 w-auto"
          fill="currentColor"
          height="16"
          style="cursor: pointer;"
          viewBox="0 0 16 16"
          width="16"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M2 13.5V7h1v6.5a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V7h1v6.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5zm11-11V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"
            fill-rule="evenodd"
          />
          <path
            d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"
            fill-rule="evenodd"
          />
        </svg>
      </span>
      <span
        class="ms-2 me-2 text-dark fw-bolder"
      >
        |
      </span>
      <span
        class="ms-2 me-2"
      >
        <a
          class="text-decoration-underline mx-auto"
          href="https://github.com/ilshaad/my-blog-site-ik"
          rel="noopener noreferrer"
          target="_blank"
          title="Github"
        >
          <svg
            class="bi bi-github"
            fill="currentColor"
            height="16"
            viewBox="0 0 16 16"
            width="16"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"
            />
          </svg>
        </a>
      </span>
      <span
        class="ms-2 me-2"
      >
        <a
          class="text-decoration-underline mx-auto"
          href="https://www.linkedin.com/in/ilshaad/"
          rel="noopener noreferrer"
          target="_blank"
          title="LinkedIn"
        >
          <svg
            class="bi bi-linkedin"
            fill="currentColor"
            height="16"
            viewBox="0 0 16 16"
            width="16"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"
            />
          </svg>
        </a>
      </span>
      <span
        class="ms-2 me-2"
      >
        <a
          class="text-decoration-underline mx-auto"
          href="https://ilshaad.com/"
          rel="noopener noreferrer"
          target="_blank"
          title="Portfolio site"
        >
          <svg
            class="bi bi-journal-code text-primary bg-light"
            fill="currentColor"
            height="16"
            viewBox="0 0 16 16"
            width="16"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M8.646 5.646a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L10.293 8 8.646 6.354a.5.5 0 0 1 0-.708zm-1.292 0a.5.5 0 0 0-.708 0l-2 2a.5.5 0 0 0 0 .708l2 2a.5.5 0 0 0 .708-.708L5.707 8l1.647-1.646a.5.5 0 0 0 0-.708z"
              fill-rule="evenodd"
            />
            <path
              d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"
            />
            <path
              d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"
            />
          </svg>
        </a>
      </span>
      <span
        class="ms-2 me-2"
      >
        <a
          class="text-decoration-underline mx-auto"
          href="mailto:rechadsalma123@gmail.com?subject=From%20ilshaad%20blog%20site%202022%3A"
          title="Email me"
        >
          <svg
            class="bi bi-envelope-fill"
            fill="currentColor"
            height="16"
            viewBox="0 0 16 16"
            width="16"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757Zm3.436-.586L16 11.801V4.697l-5.803 3.546Z"
            />
          </svg>
        </a>
      </span>
    </div>
    <nav
      aria-label="breadcrumb"
      class="d-none d-sm-block mt-2 mb-n2 ms-2 me-2 ms-xl-5 me-xl-5"
    >
      <ol
        class="breadcrumb"
      >
        <li
          class="breadcrumb-item homeBreadcrumb"
        >
          <a
            href="/"
          >
            Home
          </a>
        </li>
        <li
          aria-current="page"
          class="breadcrumb-item active"
        >
          blog
        </li>
      </ol>
    </nav>
    <div
      class="mt-3 ms-2 me-2 ms-xl-5 me-xl-5 row"
    >
      <span
        style="box-sizing: border-box; display: inline-block; overflow: hidden; background: none; opacity: 1; border: 0px; margin: 0px; padding: 0px; position: relative; max-width: 100%;"
      >
        <span
          style="box-sizing: border-box; display: block; background: none; opacity: 1; border: 0px; margin: 0px; padding: 0px; max-width: 100%;"
        >
          <img
            alt=""
            aria-hidden="true"
            src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2724%27%20height=%2724%27/%3e"
            style="display: block; max-width: 100%; background: none; opacity: 1; border: 0px; margin: 0px; padding: 0px;"
          />
        </span>
        <img
          alt="blog 5 image"
          data-nimg="intrinsic"
          decoding="async"
          src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
          style="position: absolute; top: 0px; left: 0px; bottom: 0px; right: 0px; box-sizing: border-box; padding: 0px; margin: auto; display: block; width: 0px; height: 0px; min-width: 100%; max-width: 100%; min-height: 100%; max-height: 100%;"
        />
        <noscript />
      </span>
    </div>
    <div
      class="mx-auto row"
    >
      <h1
        class="text-primary mt-3 text-center"
      >
        Deploy multiple Docker containers using Github Actions and Heroku
      </h1>
    </div>
    <div
      class="mx-auto row"
    >
      <p
        class="minuteRead text-center"
      >
        8 min read
      </p>
    </div>
    <div
      class="mb-2 mx-auto row"
    >
      <time
        class="blogDate d-block text-center"
        datetime="2022-09-02"
      >
        2022 September 2nd Friday
      </time>
    </div>
    <div
      class="mx-auto row"
    >
      <h5
        class="text-center mb-3"
      >
        Prequisite:
      </h5>
      <div
        class="mt-n2 mb-3 text-center"
      >
        <span
          class="w-auto mt-1 me-1 badge text-secondary bg-primary"
        >
          Docker
        </span>
        <span
          class="w-auto mt-1 me-1 badge text-secondary bg-primary"
        >
          Docker Compose
        </span>
        <span
          class="w-auto mt-1 me-1 badge text-secondary bg-primary"
        >
          Heroku
        </span>
        <span
          class="w-auto mt-1 me-1 badge text-secondary bg-primary"
        >
          Github Actions
        </span>
        <span
          class="w-auto mt-1 me-1 badge text-secondary bg-primary"
        >
          Fullstack - Client Side Rendering
        </span>
        <span
          class="w-auto mt-1 me-1 badge text-secondary bg-primary"
        >
          CI/CD
        </span>
      </div>
    </div>
    <div
      class="row"
      style="font-size: 0.9rem;"
    >
      <div
        class="col-9 offset-1"
      >
        <ul>
          <li>
            Should have good knowledge of Docker and Docker-Compose
          </li>
          <li>
            Installed Docker within your local device
          </li>
          <li>
            Should be registered to Heroku and Github
          </li>
          <li>
            Basic understanding of CSR and CI/CD
          </li>
        </ul>
      </div>
    </div>
    <div
      class="text-primary w-75 mx-auto overflow-hidden mt-2 row"
    >
      <hr />
    </div>
    <div
      class="row"
    >
      <div
        class="col-12"
      >
        <p>
                It is very common to deploy apps using CI/CD (Continuous Integration / Continuous Delivery). Actually, depending on which cloud application platform provider you use, all you will need to do is git push your app and they will setup a pipeline and deploy the app online for you. But it starts to get a bit complicated when you want to configure the pipeline yourself to match your app needs, plus, not to mention, it could get expensive real fast too.
        </p>
        <p>
          What if you have a fullstack app which is using client side rendering? It would mean that you will need to hook up the frontend and backend api together since they are considered as separate apps within the repo. Usually, that is not a problem in itself, but it gets tricky if you want to implement a pipeline to both the applications. To throw in another spanner in the works, let's say we are wrapping the frontend and backend in a Docker container. We are going to be doing exactly this, using Heroku as your cloud provider.
        </p>
        <p>
          Now it is worth noting that Heroku already provides a container deployment service, but it is not ideal when you have a fullstack CSR app (containing both frontend and backend), since you will have to git push them individually. Plus, having full control of your Docker means you control all app version packages from breaking and testing.
        </p>
        <p>
          Let's assume your frontend and backend is setup within your repo, we should first create a 
          <span
            class="codeText"
          >
            Dockerfile
          </span>
           file for each app, which should look something like this:
        </p>
      </div>
      <div
        class="col-12"
      >
        <pre
          class="preCode mx-auto"
        >
          <code
            class="codeTag mx-auto"
            role="code"
          >
            <div
              class="comment"
            >
              <div>
                # ./frontend/Dockerfile file
              </div>
              <br />
              <div>
                # Create a Node.js and Alpine container
              </div>
              <div>
                # Use whatever is the latest version from Docker hub
              </div>
            </div>
            <div>
              <span
                class="keyword"
              >
                FROM
              </span>
               
              <span
                class="value"
              >
                node:18.5.0-alpine3.16
              </span>
            </div>
            <br />
            <div
              class="comment"
            >
              # Create directory your app will be build in within the Alpine container
            </div>
            <div>
              <span
                class="keyword"
              >
                WORKDIR
              </span>
               
              <span
                class="value"
              >
                /frontend
              </span>
            </div>
            <br />
            <div
              class="comment"
            >
              # copy both your package.json and package-lock-json file within the /frontend directory 
            </div>
            <div>
              <span
                class="keyword"
              >
                COPY
              </span>
               
              <span
                class="value"
              >
                ./package.json .
              </span>
            </div>
            <div>
              <span
                class="keyword"
              >
                COPY
              </span>
               
              <span
                class="value"
              >
                ./package.lock.json .
              </span>
            </div>
            <br />
            <div
              class="comment"
            >
              # Install packages
            </div>
            <div>
              <span
                class="keyword"
              >
                RUN
              </span>
               
              <span
                class="value"
              >
                npm ci
              </span>
            </div>
            <br />
            <div
              class="comment"
            >
              # After install, copy all files within ./frontend directory
            </div>
            <div>
              <span
                class="keyword"
              >
                COPY
              </span>
               
              <span
                class="value"
              >
                . .
              </span>
            </div>
            <br />
            <div
              class="comment"
            >
              # Build your app
            </div>
            <div>
              <span
                class="keyword"
              >
                RUN
              </span>
               
              <span
                class="value"
              >
                npm run build
              </span>
            </div>
            <br />
            <div
              class="comment"
            >
              # Expose frontend app port number
            </div>
            <div>
              <span
                class="keyword"
              >
                EXPOSE
              </span>
               
              <span
                class="value"
              >
                3000
              </span>
            </div>
            <br />
            <div
              class="comment"
            >
              Run your frontend server
            </div>
            <div>
              <span
                class="keyword"
              >
                CMD
              </span>
               
              <span
                class="value"
              >
                npm run server
              </span>
            </div>
          </code>
        </pre>
      </div>
      <div
        class="col-12"
      >
        <p>
          Do not forget to create a 
          <span
            class="codeText"
          >
            Dockerfile
          </span>
           file for your backend app too. It should look very similar to the frontend 
          <span
            class="codeText"
          >
            Dockerfile
          </span>
           file.
        </p>
        <p>
          When both 
          <span
            class="codeText"
          >
            Dockerfile
          </span>
           files are working, you can proceed with Docker Compose which infuses both containers together.
        </p>
      </div>
      <div
        class="col-12"
      >
        <pre
          class="preCode mx-auto"
        >
          <code
            class="codeTag mx-auto"
            role="code"
          >
            <div
              class="comment"
            >
              # ./docker-compose.yml file
            </div>
            <div>
              <span
                class="keyword"
              >
                version
              </span>
              :
              <span
                class="value"
              >
                 "3.8"
              </span>
            </div>
            <div>
              <span
                class="keyword"
              >
                services
              </span>
              :
            </div>
            <div
              class="tab1"
            >
              <span
                class="keyword"
              >
                frontendApp
              </span>
              :
            </div>
            <div
              class="tab2"
            >
              <span
                class="keyword"
              >
                build
              </span>
              :
            </div>
            <div
              class="tab3"
            >
              <div>
                <span
                  class="keyword"
                >
                  context
                </span>
                : 
                <span
                  class="value"
                >
                  ./frontend
                </span>
              </div>
              <div>
                <span
                  class="keyword"
                >
                  dockerfile
                </span>
                : 
                <span
                  class="value"
                >
                  Dockerfile 
                </span>
              </div>
            </div>
            <div
              class="tab2"
            >
              <span
                class="keyword"
              >
                ports
              </span>
              :
            </div>
            <div
              class="tab3"
            >
              - 
              <span
                class="value"
              >
                "3000:3000"
              </span>
            </div>
            <br />
            <div
              class="tab1"
            >
              <span
                class="keyword"
              >
                backendApp
              </span>
              :
            </div>
            <div
              class="tab2"
            >
              <span
                class="keyword"
              >
                build
              </span>
              :
            </div>
            <div
              class="tab3"
            >
              <div>
                <span
                  class="keyword"
                >
                  context
                </span>
                : 
                <span
                  class="value"
                >
                  ./backend
                </span>
              </div>
              <div>
                <span
                  class="keyword"
                >
                  dockerfile
                </span>
                : 
                <span
                  class="value"
                >
                  Dockerfile
                </span>
              </div>
            </div>
            <div
              class="tab2"
            >
              <span
                class="keyword"
              >
                ports
              </span>
              :
            </div>
            <div
              class="tab3"
            >
              - 
              <span
                class="value"
              >
                "4000:4000"
              </span>
            </div>
          </code>
        </pre>
      </div>
      <div
        class="col-12"
      >
        <p>
          Use the 
          <span
            class="codeText"
          >
            docker-compose up
          </span>
           command in the terminal to ensure everything is running smoothly.
        </p>
        <p>
          Now we can move onto the next step, which is to create the Github Actions CI/CD pipeline (be sure you have already been registered with Github and Heroku prior). The Github Actions file is quite straightforward but you will need a few things beforehand; your Heroku email address and your Heroku api key, which can be found in your Heroku account settings. Once you get that, go to your Github app repo, and you set your environment secrets variables (found in your repo settings). Be sure to set 
          <span
            class="codeText"
          >
            HEROKU_EMAIL
          </span>
           and 
          <span
            class="codeText"
          >
            HEROKU_API_KEY
          </span>
           keys exactly as shown because your Github Actions file will search for these two secrets in order to give you access to your Heroku account.
        </p>
        <p>
          After you have set your repo secrets, we can now create the Github Actions file to deploy your fullstack docker containers.
        </p>
      </div>
      <div
        class="col-12"
      >
        <pre
          class="preCode mx-auto"
        >
          <code
            class="codeTag mx-auto"
            role="code"
          >
            <div
              class="comment"
            >
              ./.github/workflows/main.yml
            </div>
            <div>
              <span
                class="keyword"
              >
                name
              </span>
              : 
              <span
                class="value"
              >
                Fullstack CSR app
              </span>
            </div>
            <div
              class="comment"
            >
              # Setup trigger deployment when you git push in the master branch
            </div>
            <div>
              <span
                class="keyword"
              >
                on
              </span>
              :
            </div>
            <div
              class="tab1"
            >
              <span
                class="keyword"
              >
                push
              </span>
              :
            </div>
            <div
              class="tab2"
            >
              <span
                class="keyword"
              >
                branches
              </span>
              :
            </div>
            <div
              class="tab3"
            >
              - 
              <span
                class="value"
              >
                master
              </span>
            </div>
            <br />
            <div>
              <span
                class="keyword"
              >
                jobs
              </span>
              :
            </div>
            <div
              class="tab1"
            >
              <span
                class="keyword"
              >
                build
              </span>
              :
            </div>
            <div
              class="tab2"
            >
              <div>
                <span
                  class="keyword"
                >
                  runs-on
                </span>
                : 
                <span
                  class="value"
                >
                  ubuntu-latest
                </span>
              </div>
              <div>
                <span
                  class="keyword"
                >
                  steps
                </span>
                :
              </div>
            </div>
            <div
              class="tab3"
            >
              <div
                class="comment"
              >
                # Looks at your repositoty
              </div>
              <div>
                - 
                <span
                  class="keyword"
                >
                  uses
                </span>
                : 
                <span
                  class="value"
                >
                  actions/checkout@v2
                </span>
              </div>
              <div
                class="comment"
              >
                # Create and deploy your multiple containers
              </div>
              <div>
                - 
                <span
                  class="keyword"
                >
                  name
                </span>
                : 
                <span
                  class="value"
                >
                  Deploy multiple Docker images to Heroku apps
                </span>
              </div>
            </div>
            <div
              class="tab4"
            >
              <div>
                <span
                  class="keyword"
                >
                  uses
                </span>
                : 
                <span
                  class="value"
                >
                  snithyanantham/docker-compose-mulitple-apps-heroku-deploy@v1.0
                </span>
              </div>
              <div>
                <span
                  class="keyword"
                >
                  id
                </span>
                : 
                <span
                  class="value"
                >
                  heroku
                </span>
              </div>
              <div>
                <span
                  class="keyword"
                >
                  with
                </span>
                :
              </div>
            </div>
            <div
              class="tab5"
            >
              <div
                class="comment"
              >
                # Your Heroku email address
              </div>
              <div>
                <span
                  class="keyword"
                >
                  email
                </span>
                : 
                <span
                  class="value"
                >
                  \${{ secrets.HEROKU_EMAIL }}
                </span>
              </div>
              <div
                class="comment"
              >
                # Your Heroku api key
              </div>
              <div>
                <span
                  class="keyword"
                >
                  api_key
                </span>
                : 
                <span
                  class="value"
                >
                  \${{ secrets.HEROKU_API_KEY }}
                </span>
              </div>
              <div
                class="comment"
              >
                # path to your docker-compose file
              </div>
              <div>
                <span
                  class="keyword"
                >
                  docker_compose_file
                </span>
                : 
                <span
                  class="value"
                >
                  "./docker-compose.yml"
                </span>
              </div>
              <div
                class="comment"
              >
                # Set Docker images name, Heroku app name and Heroku app type
              </div>
              <div>
                <span
                  class="keyword"
                >
                  heroku_apps
                </span>
                : 
                <span
                  class="value"
                >
                  '[{"imagename":"fullstack_frontendApp", "appname":"frontend", "apptype";"web"}, {"imagename"fullstack_backendApp", "appname":"backend", "apptype":"web"}]' 
                </span>
              </div>
            </div>
          </code>
        </pre>
      </div>
      <div
        class="col-12"
      >
        <p>
          If all done correctly, everytime you git push your local repo, Github Actions will build your Docker images and deploy to Heroku.
        </p>
        <p>
          It does require a bit of configuration on your behalf, but once completed, in the long run it will serve you well, saving you more time.
        </p>
      </div>
    </div>
  </div>
</div>
`;
